CFLAGS = -Wall -Werror
export PATH := $(PATH):/home/ryan/projects/aarch64_toolchain_install_dir/install/arm-gnu-toolchain-13.3.rel1-x86_64-aarch64-none-linux-gnu/bin

all: aesdsocket

aesdsocket: aesdsocket.c
ifdef CROSS_COMPILE
	$(CROSS_COMPILE)gcc aesdsocket.c -o aesdsocket
else
	${CC} aesdsocket.c -o aesdsocket	
endif

util_test: util_test.c
	${CC} util_test.c -o util_test

clean:
	rm -f aesdsocket *.o
	rm -f util_test *.o



all: aesdsocket

ifdef CROSS_COMPILE
	aesdsocket: aesdsocket.o utils.o
		$(CROSS_COMPILE)gcc ${CFLAGS} -o aesdsocket aesdsocket.o utils.o 

	aesdsocket.o: aesdsocket.c ${UTILS_HEADER}
		$(CROSS_COMPILE)gcc ${CFLAGS} -c aesdsocket.c

	utils.o: ${UTILS_SOURCE} ${UTILS_HEADER}
		$(CROSS_COMPILE)gcc ${CFLAGS} -c ${UTILS_SOURCE}
else
	aesdsocket: aesdsocket.o utils.o
		${CC} ${CFLAGS} -o aesdsocket aesdsocket.o utils.o 

	aesdsocket.o: aesdsocket.c ${UTILS_HEADER}
		${CC} ${CFLAGS} -c aesdsocket.c

	utils.o: ${UTILS_SOURCE} ${UTILS_HEADER}
		${CC} ${CFLAGS} -c ${UTILS_SOURCE}
endif